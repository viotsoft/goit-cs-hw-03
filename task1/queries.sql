-------------------------------------------------------
-- 1. Отримати всі завдання певного користувача за його user_id
-------------------------------------------------------
-- Замініть :user_id на конкретне значення, наприклад, 1
SELECT *
FROM tasks
WHERE user_id = :user_id;

-------------------------------------------------------
-- 2. Вибрати завдання за певним статусом (наприклад, 'new')
-------------------------------------------------------
SELECT *
FROM tasks
WHERE status_id = (
    SELECT id
    FROM status
    WHERE name = 'new'
);

-------------------------------------------------------
-- 3. Оновити статус конкретного завдання на 'in progress'
-------------------------------------------------------
-- Замініть :task_id на id завдання, яке потрібно оновити
SELECT 
    t.id AS task_id,
    t.title,
    t.description,
    s.name AS status_name,  -- тут ви побачите замість 1, 2, 3, тощо
    t.user_id
FROM tasks t
JOIN status s ON t.status_id = s.id;


-------------------------------------------------------
-- 4. Отримати список користувачів, які не мають жодного завдання
-------------------------------------------------------
SELECT *
FROM users
WHERE id NOT IN (
    SELECT DISTINCT user_id
    FROM tasks
);

-------------------------------------------------------
-- 5. Додати нове завдання для конкретного користувача
-------------------------------------------------------
-- Замініть :user_id на id користувача, для якого додається завдання
INSERT INTO tasks (title, description, status_id, user_id)
VALUES (
    'Нове завдання',
    'Опис нового завдання',
    (SELECT id FROM status WHERE name = 'new'),
    :user_id
);

-------------------------------------------------------
-- 6. Отримати всі завдання, які ще не завершено (тобто статус не 'completed')
-------------------------------------------------------
SELECT *
FROM tasks
WHERE status_id <> (
    SELECT id FROM status WHERE name = 'completed'
);

-------------------------------------------------------
-- 7. Видалити конкретне завдання за його id
-------------------------------------------------------
-- Замініть :task_id на id завдання, яке потрібно видалити
DELETE FROM tasks
WHERE id = :task_id;

-------------------------------------------------------
-- 8. Знайти користувачів з певною електронною поштою (наприклад, містять 'example.com')
-------------------------------------------------------
SELECT *
FROM users
WHERE email LIKE '%example.com%';

-------------------------------------------------------
-- 9. Оновити ім'я користувача
-------------------------------------------------------
-- Замініть :user_id на id користувача, а 'Нове ім’я' — на нове значення
UPDATE users
SET fullname = 'Нове ім’я'
WHERE id = :user_id;

-------------------------------------------------------
-- 10. Отримати кількість завдань для кожного статусу
-------------------------------------------------------
SELECT s.name AS status, COUNT(t.id) AS task_count
FROM status s
LEFT JOIN tasks t ON s.id = t.status_id
GROUP BY s.name
ORDER BY s.name;

-------------------------------------------------------
-- 11. Отримати завдання, які призначені користувачам з певною доменною частиною електронної пошти
-------------------------------------------------------
SELECT t.*
FROM tasks t
JOIN users u ON t.user_id = u.id
WHERE u.email LIKE '%@example.com%';

-------------------------------------------------------
-- 12. Отримати список завдань, що не мають опису
-------------------------------------------------------
SELECT *
FROM tasks
WHERE description IS NULL OR description = '';

-------------------------------------------------------
-- 13. Вибрати користувачів та їхні завдання, які є у статусі 'in progress'
-------------------------------------------------------
SELECT u.fullname, t.*
FROM users u
INNER JOIN tasks t ON u.id = t.user_id
WHERE t.status_id = (
    SELECT id FROM status WHERE name = 'in progress'
);

-------------------------------------------------------
-- 14. Отримати користувачів та кількість їхніх завдань
-------------------------------------------------------
SELECT u.fullname, COUNT(t.id) AS task_count
FROM users u
LEFT JOIN tasks t ON u.id = t.user_id
GROUP BY u.fullname
ORDER BY task_count DESC;
